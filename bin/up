#!/bin/bash -e
#
# DMC Up Script
########################################################################

# source configuration
VERBOSE=1 . bin/env &>/dev/null

discover() {
	for SHARE in ${SHARES[@]}; do
		search && return 0
	done
	return 1
}

search() {
	for VOLUME in ${DOCKER_VOLUMES[@]}; do
		[[ "$VOLUME" == "$SHARE" ]] && return 0
	done
	return 1
}

if [ "${SHARES[*]}" != "" ]; then
	discover || bin/initialize
fi

# start private network
NETWORK=$(docker network ls | grep -c "$APPLICATION") || true
(( $NETWORK )) || docker network create "$APPLICATION"

# start application
docker-compose -f etc/docker/compose.yml up -d
